<ng-container *ngIf="!onlySchoolProducts || schoolIncluded"> 
  <mat-expansion-panel (opened) ="panelOpenState = true" (closed)="panelOpenState = false" [expanded]="panelOpenState" [ngClass]="{'sub-type' : subType}">
    <mat-expansion-panel-header>
      <mat-panel-title>
        {{type.typeName}}
      </mat-panel-title>
      <mat-panel-description>
        {{panelOpenState ? 'close' : 'open'}}
      </mat-panel-description>
    </mat-expansion-panel-header>
    <mat-card *ngIf="typeMaxAmount != null" [ngClass]="{'sub-type-max-amount' : subType}">
      {{'You are allowed ' + typeMaxAmount + ' items from the below products.'}}
      <br>
      {{'Each item is 1 ' + type.unit  + '.'}}
      <br>
      {{typeAmountInCart === 0 ? 'None in Cart':
          typeAmountInCart >= 1 ? 
          typeAmountInCart + ' ' + type.typeName + ' Products in Cart' : 
          typeAmountInCart + ' ' + type.typeName + ' Product in Cart'
      }}
    </mat-card>
    <ng-container *ngFor="let productType of productTypes">
      <ng-container *ngIf="productType.productId">
        <app-product (addOneTypeAmount)="updateTypeAmount($event)" [atTypeMaxAmount]="atTypeMaxAmount" 
        [family]="family" [product]="productType" [superTypeName]="superTypeName" [type]="type">
        </app-product>
      </ng-container>
      <ng-container *ngIf="productType.typeId">    
        <app-product-type [family]="family" [superTypeName]="superTypeName" [type]="productType"></app-product-type>
      </ng-container>  
    </ng-container>       
    <mat-action-row (click)="closePanel()"></mat-action-row>
  </mat-expansion-panel>
</ng-container>   
